<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <div>
      <h1>Welcome, {{ user?.name || 'Candidate' }}!</h1>
      <p class="subtitle">Track your interview progress and performance</p>
    </div>
    <div class="header-actions">
      <button class="btn-primary" (click)="startNewInterview()">
        + New Interview
      </button>
      <button class="btn-secondary" (click)="logout()">
        Logout
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading">
    <p>Loading your dashboard...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error">
    <!-- Statistics Cards -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">üìä</div>
        <div class="stat-content">
          <p class="stat-label">Total Interviews</p>
          <p class="stat-value">{{ totalInterviews }}</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">‚úÖ</div>
        <div class="stat-content">
          <p class="stat-label">Completed</p>
          <p class="stat-value">{{ completedInterviews }}</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">‚≠ê</div>
        <div class="stat-content">
          <p class="stat-label">Average Score</p>
          <p class="stat-value">{{ averageScore }}%</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">‚ùì</div>
        <div class="stat-content">
          <p class="stat-label">Questions Answered</p>
          <p class="stat-value">{{ latestSession?.questions?.length || 0 }}</p>
        </div>
      </div>
    </div>

    <!-- Latest Interview Feedback -->
    <div *ngIf="latestSession && latestSession.status === 'completed'" class="feedback-section">
      <h2>Latest Interview Feedback</h2>
      <div class="feedback-card">
        <div class="feedback-scores">
          <div class="score-item">
            <span class="score-label">Overall Score</span>
            <span class="score-value">{{ latestSession.evaluation?.overallScore || 0 }}/10</span>
          </div>
          <div class="score-item">
            <span class="score-label">Confidence</span>
            <span class="score-value">{{ latestSession.evaluation?.confidenceLevel || 0 }}/10</span>
          </div>
          <div class="score-item">
            <span class="score-label">DSA Level</span>
            <span class="score-value">{{ latestSession.evaluation?.dsaLevel || 0 }}/10</span>
          </div>
        </div>
        <div class="feedback-text">
          <p *ngIf="latestSession.evaluation?.feedback">
            {{ latestSession.evaluation.feedback }}
          </p>
          <p *ngIf="!latestSession.evaluation?.feedback" class="no-feedback">
            AI feedback will be generated after interview evaluation.
          </p>
        </div>
      </div>
    </div>

    <!-- Interview History -->
    <div class="history-section">
      <h2>Interview History</h2>
      
      <div *ngIf="sessions.length === 0" class="empty-state">
        <p>üéØ No interviews yet</p>
        <p class="empty-subtitle">Start your first interview to track your progress</p>
        <button class="btn-primary" (click)="startNewInterview()">
          Start Interview
        </button>
      </div>

      <div *ngIf="sessions.length > 0" class="history-table">
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Status</th>
              <th>Questions</th>
              <th>Score</th>
              <th>State</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let session of sessions">
              <td>{{ formatDate(session.createdAt) }}</td>
              <td>
                <span class="status-badge" [style.background-color]="getStatusColor(session.status)">
                  {{ session.status }}
                </span>
              </td>
              <td>{{ session.questions?.length || 0 }}</td>
              <td>{{ session.evaluation?.overallScore || 0 }}%</td>
              <td><span class="state-badge">{{ session.currentState }}</span></td>
              <td>
                <button class="btn-view" (click)="viewSession(session._id)">
                  {{ session.status === 'completed' ? 'View' : 'Continue' }}
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
